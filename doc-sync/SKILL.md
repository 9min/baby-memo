---
name: doc-sync
description: >
  프로젝트 코드베이스와 문서의 정합성을 검사하고 동기화하는 스킬.
  다음과 같은 요청 시 사용: 문서 동기화, 문서 업데이트, 현행화, 정합성 검사,
  sync docs, update documentation, align docs with code 등
  프로젝트 내 모든 문서 대상 (CLAUDE.md, PRD, 아키텍처 문서, .md, .pm, .rule 파일 등).
---

# Doc Sync

프로젝트 코드베이스를 분석하여 모든 프로젝트 문서가 현재 코드 상태를 정확히 반영하도록 동기화한다.
문서와 코드 간의 불일치를 탐지하고, 수정안을 제안한 뒤 적용한다.

## 워크플로우

### 1단계: 문서 탐색

1. 프로젝트 내 모든 문서 파일을 식별:
   - 루트 레벨: `CLAUDE.md`, `README.md`, `CONTRIBUTING.md`, `.cursorrules`, `.clinerules` 등
   - 문서 디렉토리: `docs/`, `doc/`, `.github/` 등
   - 설정 관련 문서: `*.md`, `*.pm`, `*.rule` 패턴에 해당하는 파일
   - 프레임워크 전용: `.cursor/rules/*.mdc`, `.clinerules`, `.roomodes` 등
2. 각 문서를 읽고 **검증 가능한 주장**을 추출 (파일 경로, 디렉토리 구조, 명령어 목록, 의존성 이름, 버전 번호, API 시그니처, 라우트 정의, 설정값, 수치/통계 등).

### 2단계: 코드 대조 분석

각 주장을 실제 코드베이스와 대조하여 검증:

| 주장 유형 | 검증 방법 |
|---|---|
| 파일/디렉토리 경로 | Glob으로 존재 여부 확인 |
| 프로젝트 구조 트리 | Glob 결과와 문서 트리 비교 |
| CLI 명령어 | `package.json` scripts, `Makefile` 등 확인 |
| 의존성 및 버전 | `package.json`, `requirements.txt`, `go.mod` 등 확인 |
| 라우트 정의 | 소스 코드에서 라우트 패턴 Grep |
| 컴포넌트/함수 이름 | 선언부 Grep |
| 스토어/모듈 목록 | 소스 디렉토리 Glob |
| 테스트 수 | 테스트 스위트 실행 또는 테스트 파일/케이스 수 집계 |
| 설정값 | 설정 파일 읽기 |
| 타입/인터페이스 정의 | 타입 정의 파일 읽기 |

### 3단계: 리포트

변경 적용 전, 구조화된 차이 리포트를 먼저 제시:

```
## 문서 동기화 리포트

### [파일명]

#### 불일치 발견
- [ ] XX행: "X개 파일"이라고 기술되어 있으나 실제로는 Y개 파일 존재
- [ ] XX행: `foo/` 디렉토리가 기재되어 있으나 `bar/`로 이름 변경됨
- [ ] XX행: 새 모듈 `baz.ts`가 구조 트리에 누락됨
- [ ] XX행: 버전 2.0으로 기재되어 있으나 package.json에는 3.1

#### 최신 상태 (변경 불필요)
- XX행: 라우트 정의 일치
- XX행: 기술 스택 설명 정확
```

### 4단계: 수정 적용

사용자 확인 후 Edit 도구로 각 문서를 수정. 다음을 반드시 보존:
- 원본 문서의 어조와 서식 스타일
- 섹션 순서와 계층 구조
- 문서 언어 (한국어/영어 등 — 기존 문서 언어를 따름)
- 코드에서 도출되지 않는 정보 (설계 이유, 비즈니스 맥락, 향후 계획)

검증 가능한 사실적 주장만 수정한다. 검증 불가능한 맥락(목표, 근거, 컨벤션, 가이드라인)이 포함된 섹션은 절대 삭제하지 않는다.

## 검증 체크리스트

일반적인 문서 섹션별 검증 항목:

- **기술 스택**: 의존성 이름과 메이저 버전을 lock 파일과 대조
- **프로젝트 구조**: 모든 디렉토리를 Glob하여 문서 트리와 비교; 누락 또는 잉여 항목 표시
- **명령어**: 각 명령어가 `package.json` scripts 등에 실제로 존재하는지 확인
- **라우트/엔드포인트**: 소스에서 라우트 정의를 Grep하여 비교
- **파일 수**: 문서에 기재된 패턴과 일치하는 실제 파일 수 집계
- **테스트 수**: `describe`/`it`/`test` 블록 수 집계 또는 테스트 스위트 실행
- **스토어/훅/유틸 목록**: 해당 디렉토리를 Glob하여 비교
- **컴포넌트 목록**: 컴포넌트 디렉토리를 Glob하여 비교
- **마이그레이션 수**: 마이그레이션 디렉토리의 파일 수 집계
- **환경 변수**: `process.env` 또는 프레임워크별 env 접근 패턴을 Grep

## 예외 상황

- **모호한 주장**: 코드 검사로 검증할 수 없는 문서 서술(예: "빠른 성능")은 건너뛰고 검증 불가로 표기.
- **자동 생성 문서**: 자동 생성된 것으로 보이는 문서(예: OpenAPI 기반 API 문서)는 직접 수정 대신 소스 생성기를 다시 실행하라고 안내.
- **문서 간 충돌**: 두 문서가 서로 모순되면 양쪽 모두 표시하고 사용자에게 어느 쪽이 기준인지 확인.
- **대규모 프로젝트**: 문서가 많은 프로젝트는 CLAUDE.md와 루트 레벨 문서를 먼저 처리한 후 하위 디렉토리를 탐색.

## 참조 자료

각 주장 유형별 구체적인 검증 패턴은 [references/verification-patterns.md](references/verification-patterns.md) 참조.
